<!DOCTYPE html><html lang="pl"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Biedronka/Lidl Kalkulator</title><script src="https://unpkg.com/react@18/umd/react.production.min.js"></script><script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script><script src="https://unpkg.com/@babel/standalone/babel.min.js"></script><script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script><script src="https://cdn.tailwindcss.com"></script><style>html,body{height:100%;overflow:hidden}#root{height:100vh;overflow:hidden}</style></head><body><div id="root"></div><script type="text/babel">const{useState:_0x1a2b,useRef:_0x3c4d,useEffect:_0x5e6f}=React;const{Plus:_0x7g8h,Trash2:_0x9i0j,Calculator:_0xak1l,FileText:_0xcm2n,Download:_0xeo3p,Upload:_0xgq4r}=lucide;const _0xis5t=()=>{const[_0xku6v,_0xmw7x]=_0x1a2b([]);const[_0xoy8z,_0xqa9b]=_0x1a2b('');const[_0xsb0c,_0xud1e]=_0x1a2b([]);const[_0xwf2g,_0xyh3i]=_0x1a2b(false);const[_0xzj4k,_0xbl5m]=_0x1a2b(null);const _0xdn6o=_0x3c4d();const _0xfp7q={C47:{name:'MIX CHLEBÓW BIEDRONKA 4X JASNY + 4X CIEMNY Z ZIAR',components:[{index:'BLC45-U-000',quantity:4},{index:'BLC46-U-000',quantity:4}],cartonsPerPallet:64},C50:{name:'MIX CHLEBÓW LIDL 3X JASNY + 3X CIEMNY Z ZIAR',components:[{index:'BLC48-U-000',quantity:3},{index:'BLC49-U-000',quantity:3}],cartonsPerPallet:72}};const _0xhr8s=()=>{console.log('Parsowanie danych SAP...');const _0xjt9u=_0xoy8z.trim().split('\n');const _0xlv0w=[];_0xjt9u.forEach((_0xnx1y,_0xpz2a)=>{let _0xrb3c=_0xnx1y.trim().split('\t');if(_0xrb3c.length<4){_0xrb3c=_0xnx1y.trim().split(';')}if(_0xrb3c.length<4){_0xrb3c=_0xnx1y.trim().split(',')}if(_0xrb3c.length>=4){const[_0xtd4e,_0xvf5g,_0xxh6i,_0xzj7k]=_0xrb3c;const _0xbl8m=_0xvf5g.replace(/\./g,'').replace(',','.');const _0xdn9o=parseInt(_0xbl8m);const _0xfq0r=_0xzj7k.trim().split('.');if(_0xfq0r.length===3){const _0xhs1t=`${_0xfq0r[2]}-${_0xfq0r[1].padStart(2,'0')}-${_0xfq0r[0].padStart(2,'0')}`;if(!isNaN(_0xdn9o)&&_0xdn9o>0){_0xlv0w.push({id:Date.now()+_0xpz2a,index:_0xtd4e.trim(),quantity:_0xdn9o,batch:_0xxh6i.trim(),expiryDate:_0xhs1t})}}}});console.log('Sparsowane dane:',_0xlv0w);_0xud1e(_0xlv0w);_0xyh3i(_0xlv0w.length>0);if(_0xlv0w.length===0){alert('Nie udało się sparsować danych. Sprawdź format (dane powinny być rozdzielone tabulatorami).')}};const _0xju2v=()=>{_0xmw7x([..._0xku6v,..._0xsb0c]);_0xqa9b('');_0xud1e([]);_0xyh3i(false)};const _0xlw3x=()=>{_0xud1e([]);_0xyh3i(false)};const _0xny4z=(_0xqa5b)=>{_0xmw7x(_0xku6v.filter(_0xsc6d=>_0xsc6d.id!==_0xqa5b))};const _0xue7f=()=>{_0xmw7x([]);_0xbl5m(null)};const _0xwg8h=()=>{console.log('Rozpoczynam obliczenia...');console.log('Dane wejściowe:',_0xku6v);const _0xyi9j={C47:[],C50:[],remainders:{}};try{const _0xak0l={};_0xku6v.forEach(_0xcm1n=>{if(!_0xak0l[_0xcm1n.index]){_0xak0l[_0xcm1n.index]=[]}_0xak0l[_0xcm1n.index].push({quantity:parseInt(_0xcm1n.quantity),batch:_0xcm1n.batch,expiryDate:_0xcm1n.expiryDate})});console.log('Zgrupowane dane:',_0xak0l);Object.keys(_0xak0l).forEach(_0xeo2p=>{_0xak0l[_0xeo2p].sort((_0xgq3r,_0xis4t)=>new Date(_0xgq3r.expiryDate)-new Date(_0xis4t.expiryDate))});if(_0xak0l['BLC45-U-000']&&_0xak0l['BLC46-U-000']){console.log('Obliczam palety C47...');_0xku5v('C47',_0xak0l['BLC45-U-000'],_0xak0l['BLC46-U-000'],_0xyi9j)}else{console.log('Brak danych dla C47 (wymagane BLC45-U-000 i BLC46-U-000)')}if(_0xak0l['BLC48-U-000']&&_0xak0l['BLC49-U-000']){console.log('Obliczam palety C50...');_0xku5v('C50',_0xak0l['BLC48-U-000'],_0xak0l['BLC49-U-000'],_0xyi9j)}else{console.log('Brak danych dla C50 (wymagane BLC48-U-000 i BLC49-U-000)')}console.log('Wyniki obliczeń:',_0xyi9j);_0xbl5m(_0xyi9j)}catch(_0xmw6x){console.error('Błąd podczas obliczeń:',_0xmw6x);alert('Wystąpił błąd podczas obliczeń. Sprawdź konsolę przeglądarki (F12) dla szczegółów.')}};const _0xku5v=(_0xoy7z,_0xqa8b,_0xsc9d,_0xue0f)=>{const _0xwg1h=_0xfp7q[_0xoy7z];const _0xyi2j=_0xwg1h.components[0].quantity;const _0xak3l=_0xwg1h.components[1].quantity;const _0xcm4n=_0xwg1h.cartonsPerPallet;const _0xeo5p=_0xqa8b.map(_0xgq6r=>({..._0xgq6r}));const _0xis7t=_0xsc9d.map(_0xku8v=>({..._0xku8v}));const _0xmw9x=_0xeo5p.reduce((_0xoy0z,_0xqa1b)=>_0xoy0z+_0xqa1b.quantity,0);const _0xsc2d=_0xis7t.reduce((_0xue3f,_0xwg4h)=>_0xue3f+_0xwg4h.quantity,0);const _0xyi5j=Math.min(Math.floor(_0xmw9x/_0xyi2j),Math.floor(_0xsc2d/_0xak3l));console.log(`${_0xoy7z}: Maksymalna możliwa ilość kartonów: ${_0xyi5j}`);let _0xak6l=0;let _0xcm7n=0;let _0xeo8p=[];while(_0xak6l<_0xyi5j){const _0xgq9r=_0xyi5j-_0xak6l;if(_0xgq9r<_0xcm4n&&_0xcm7n===0){break}let _0xis0t=_0xyi2j;let _0xku1v=_0xak3l;const _0xmw2x={[_0xwg1h.components[0].index]:[],[_0xwg1h.components[1].index]:[]};for(let _0xoy3z=0;_0xoy3z<_0xeo5p.length&&_0xis0t>0;_0xoy3z++){if(_0xeo5p[_0xoy3z].quantity>0){const _0xqa4b=Math.min(_0xis0t,_0xeo5p[_0xoy3z].quantity);_0xeo5p[_0xoy3z].quantity-=_0xqa4b;_0xis0t-=_0xqa4b;if(_0xqa4b>0){_0xmw2x[_0xwg1h.components[0].index].push({batch:_0xeo5p[_0xoy3z].batch,quantity:_0xqa4b,expiryDate:_0xeo5p[_0xoy3z].expiryDate})}}}for(let _0xsc5d=0;_0xsc5d<_0xis7t.length&&_0xku1v>0;_0xsc5d++){if(_0xis7t[_0xsc5d].quantity>0){const _0xue6f=Math.min(_0xku1v,_0xis7t[_0xsc5d].quantity);_0xis7t[_0xsc5d].quantity-=_0xue6f;_0xku1v-=_0xue6f;if(_0xue6f>0){_0xmw2x[_0xwg1h.components[1].index].push({batch:_0xis7t[_0xsc5d].batch,quantity:_0xue6f,expiryDate:_0xis7t[_0xsc5d].expiryDate})}}}if(_0xis0t>0||_0xku1v>0){break}_0xeo8p.push(_0xmw2x);_0xcm7n++;_0xak6l++;if(_0xcm7n===_0xcm4n){const _0xwg7h={};let _0xyi8j=null;_0xeo8p.forEach(_0xak9l=>{Object.entries(_0xak9l).forEach(([_0xcm0n,_0xeo1p])=>{_0xeo1p.forEach(_0xgq2r=>{const _0xis3t=`${_0xcm0n}|${_0xgq2r.batch}|${_0xgq2r.expiryDate}`;if(!_0xwg7h[_0xis3t]){_0xwg7h[_0xis3t]={index:_0xcm0n,batch:_0xgq2r.batch,quantity:0,expiryDate:_0xgq2r.expiryDate}}_0xwg7h[_0xis3t].quantity+=_0xgq2r.quantity;const _0xku4v=new Date(_0xgq2r.expiryDate);if(!_0xyi8j||_0xku4v<_0xyi8j){_0xyi8j=_0xku4v}})})});_0xue0f[_0xoy7z].push({expiryDate:_0xyi8j.toISOString().split('T')[0],cartonsCount:_0xcm4n,isFull:true,components:Object.values(_0xwg7h).sort((_0xmw5x,_0xoy6z)=>{if(_0xmw5x.index!==_0xoy6z.index)return _0xmw5x.index.localeCompare(_0xoy6z.index);return new Date(_0xmw5x.expiryDate)-new Date(_0xoy6z.expiryDate)})});_0xcm7n=0;_0xeo8p=[]}}const _0xqa7b=_0xeo5p.reduce((_0xsc8d,_0xue9f)=>_0xsc8d+_0xue9f.quantity,0);const _0xwg0h=_0xis7t.reduce((_0xyi1j,_0xak2l)=>_0xyi1j+_0xak2l.quantity,0);if(_0xqa7b>0||_0xwg0h>0){if(!_0xue0f.remainders){_0xue0f.remainders={}}_0xue0f.remainders[_0xoy7z]={[_0xwg1h.components[0].index]:_0xeo5p.filter(_0xcm3n=>_0xcm3n.quantity>0),[_0xwg1h.components[1].index]:_0xis7t.filter(_0xeo4p=>_0xeo4p.quantity>0)}}console.log(`${_0xoy7z}: Wyprodukowano ${_0xue0f[_0xoy7z].length} pełnych palet`)};const _0xgq5r=()=>{const _0xis6t=_0xdn6o.current;const _0xku7v=window.open('','','left=0,top=0,width=800,height=900,toolbar=0,scrollbars=0,status=0');_0xku7v.document.write(`<html><head><title>Lista pakowania</title><style>body{font-family:Arial,sans-serif;padding:20px}h1{font-size:20px;margin-bottom:20px}.pallet-item{margin:20px 0;padding:10px;border:1px solid #ccc;page-break-inside:avoid}.pallet-header{display:flex;align-items:center;margin-bottom:10px;font-weight:bold}.checkbox{width:20px;height:20px;margin-right:10px;display:inline-block}.components{margin-left:30px;font-size:12px;color:#333}.component-item{margin:3px 0}.remainders{margin-top:30px;padding:15px;background:#fff3cd;border:1px solid #ffc107}.remainders h2{font-size:16px;margin-bottom:10px;color:#856404}@media print{body{margin:0}.pallet-item{page-break-inside:avoid}}</style></head><body>${_0xis6t.innerHTML}</body></html>`);_0xku7v.document.close();_0xku7v.focus();_0xku7v.print();_0xku7v.close()};const _0xmw8x=(_0xoy9z)=>{return new Date(_0xoy9z).toLocaleDateString('pl-PL')};const _0xqa0b=(_0xsc1d)=>{return _0xsc1d.toString().replace(/\B(?=(\d{3})+(?!\d))/g,'.')};return(<div className="h-screen flex flex-col bg-gray-50"><div className="bg-white shadow-sm px-6 py-4 flex-shrink-0"><h1 className="text-2xl font-bold text-gray-800">Biedronka/Lidl Kalkulator</h1></div><div className="flex-1 flex overflow-hidden"><div className="w-1/2 flex flex-col p-4 space-y-4"><div className="bg-white rounded-lg shadow-md p-4 flex-shrink-0"><h2 className="text-lg font-semibold mb-3 text-gray-700">Wprowadź dane z SAP</h2><p className="text-xs text-gray-600 mb-3">Produkt; Ilość; Partia; TW/MTW</p><textarea value={_0xoy8z} onChange={(_0xue2f)=>_0xqa9b(_0xue2f.target.value)} placeholder="BLC45-U-000	18.311	251130124	30.11.2025
BLC46-U-000	320	251201131	01.12.2025" className="w-full h-24 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-xs"/><button onClick={_0xhr8s} disabled={!_0xoy8z} className="mt-3 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors flex items-center disabled:bg-gray-400 text-sm">Parsuj dane</button></div>{_0xwf2g&&_0xsb0c.length>0&&(<div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex-shrink-0"><h3 className="text-base font-semibold mb-3 text-gray-700">Podgląd sparsowanych danych</h3><div className="overflow-auto max-h-40 mb-3"><table className="w-full border-collapse text-xs"><thead><tr className="bg-gray-100"><th className="border border-gray-300 px-2 py-1 text-left">Indeks</th><th className="border border-gray-300 px-2 py-1 text-left">Ilość</th><th className="border border-gray-300 px-2 py-1 text-left">Partia</th><th className="border border-gray-300 px-2 py-1 text-left">Termin</th></tr></thead><tbody>{_0xsb0c.map(_0xwg3h=>(<tr key={_0xwg3h.id}><td className="border border-gray-300 px-2 py-1">{_0xwg3h.index}</td><td className="border border-gray-300 px-2 py-1">{_0xqa0b(_0xwg3h.quantity)}</td><td className="border border-gray-300 px-2 py-1">{_0xwg3h.batch}</td><td className="border border-gray-300 px-2 py-1">{_0xmw8x(_0xwg3h.expiryDate)}</td></tr>))}</tbody></table></div><div className="flex gap-3"><button onClick={_0xju2v} className="bg-green-500 text-white px-3 py-1.5 rounded-md hover:bg-green-600 transition-colors text-sm">Dodaj do listy</button><button onClick={_0xlw3x} className="bg-red-500 text-white px-3 py-1.5 rounded-md hover:bg-red-600 transition-colors text-sm">Anuluj</button></div></div>)}{_0xku6v.length>0&&(<div className="bg-white rounded-lg shadow-md p-4 flex-1 flex flex-col min-h-0"><div className="flex justify-between items-center mb-3 flex-shrink-0"><h2 className="text-lg font-semibold text-gray-700">Dane składników</h2><button onClick={_0xue7f} className="bg-red-500 text-white px-3 py-1.5 rounded-md hover:bg-red-600 transition-colors flex items-center text-xs">Usuń wszystkie</button></div><div className="overflow-auto flex-1"><table className="w-full border-collapse text-sm"><thead className="sticky top-0 bg-gray-100"><tr><th className="border border-gray-300 px-3 py-2 text-left">Indeks</th><th className="border border-gray-300 px-3 py-2 text-left">Ilość</th><th className="border border-gray-300 px-3 py-2 text-left">Partia</th><th className="border border-gray-300 px-3 py-2 text-left">Termin</th><th className="border border-gray-300 px-3 py-2 text-center">Opcje</th></tr></thead><tbody>{_0xku6v.map(_0xyi4j=>(<tr key={_0xyi4j.id}><td className="border border-gray-300 px-3 py-2">{_0xyi4j.index}</td><td className="border border-gray-300 px-3 py-2">{_0xqa0b(_0xyi4j.quantity)}</td><td className="border border-gray-300 px-3 py-2">{_0xyi4j.batch}</td><td className="border border-gray-300 px-3 py-2">{_0xmw8x(_0xyi4j.expiryDate)}</td><td className="border border-gray-300 px-3 py-2 text-center"><button onClick={()=>_0xny4z(_0xyi4j.id)} className="text-red-500 hover:text-red-700">🗑️</button></td></tr>))}</tbody></table></div><div className="mt-3 flex justify-center flex-shrink-0"><button onClick={_0xwg8h} disabled={_0xku6v.length===0} className="bg-green-500 text-white px-5 py-2 rounded-md hover:bg-green-600 transition-colors flex items-center disabled:bg-gray-400 text-sm">Oblicz palety</button></div></div>)}</div>{_0xzj4k&&(<div className="w-1/2 p-4"><div className="bg-white rounded-lg shadow-md p-4 h-full flex flex-col"><div className="flex justify-between items-center mb-4 flex-shrink-0"><h2 className="text-lg font-semibold text-gray-700">Wyniki obliczeń</h2><button onClick={_0xgq5r} className="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors flex items-center text-sm">Generuj PDF</button></div><div className="overflow-auto flex-1">{Object.entries(_0xzj4k).filter(([_0xak5l])=>_0xak5l!=='remainders').map(([_0xcm6n,_0xeo7p])=>(<div key={_0xcm6n} className="mb-4"><h3 className="text-base font-semibold mb-2">{_0xcm6n} - {_0xfp7q[_0xcm6n].name}</h3>{_0xeo7p.length>0?(<div><table className="w-full border-collapse text-sm mb-2"><thead><tr className="bg-gray-100"><th className="border border-gray-300 px-2 py-1 text-left">Nr</th><th className="border border-gray-300 px-2 py-1 text-left">Termin</th><th className="border border-gray-300 px-2 py-1 text-left">Kartony</th><th className="border border-gray-300 px-2 py-1 text-left">Składowe</th></tr></thead><tbody>{_0xeo7p.map((_0xgq8r,_0xis9t)=>(<tr key={_0xis9t}><td className="border border-gray-300 px-2 py-1 font-semibold">{_0xis9t+1}</td><td className="border border-gray-300 px-2 py-1">{_0xmw8x(_0xgq8r.expiryDate)}</td><td className="border border-gray-300 px-2 py-1">{_0xgq8r.cartonsCount}</td><td className="border border-gray-300 px-2 py-1 text-xs">{_0xgq8r.components&&_0xgq8r.components.map((_0xku0v,_0xmw1x)=>(<div key={_0xmw1x}>{_0xku0v.index}: {_0xqa0b(_0xku0v.quantity)} szt. (p: {_0xku0v.batch})</div>))}</td></tr>))}</tbody></table><div className="text-xs text-gray-600"><p>Łącznie palet: {_0xeo7p.length}, kartonów: {_0xeo7p.reduce((_0xoy2z,_0xqa3b)=>_0xoy2z+_0xqa3b.cartonsCount,0)}</p></div></div>):(<p className="text-gray-500 text-sm">Brak palet do wyprodukowania</p>)}</div>))}{_0xzj4k.remainders&&Object.keys(_0xzj4k.remainders).length>0&&(<div className="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded"><h3 className="text-base font-semibold mb-2 text-yellow-800">Pozostało:</h3>{Object.entries(_0xzj4k.remainders).map(([_0xsc4d,_0xue5f])=>(<div key={_0xsc4d} className="mb-2"><p className="font-semibold text-yellow-700 text-sm">{_0xsc4d}:</p>{Object.entries(_0xue5f).map(([_0xwg6h,_0xyi7j])=>(<div key={_0xwg6h} className="ml-3 text-xs"><p className="font-medium">{_0xwg6h}:</p>{_0xyi7j.map((_0xak8l,_0xcm9n)=>(<p key={_0xcm9n} className="ml-3">Partia {_0xak8l.batch}: {_0xqa0b(_0xak8l.quantity)} szt. ({_0xmw8x(_0xak8l.expiryDate)})</p>))}</div>))}</div>))}</div>)}</div></div></div>)}</div><div style={{display:'none'}}><div ref={_0xdn6o}><h1>Lista pakowania {new Date().toLocaleDateString('pl-PL')}</h1>{_0xzj4k&&Object.entries(_0xzj4k).filter(([_0xeo0p])=>_0xeo0p!=='remainders').map(([_0xgq1r,_0xis2t])=>(<div key={_0xgq1r}>{_0xis2t.map((_0xku3v,_0xmw4x)=>(<div key={_0xmw4x} className="pallet-item"><div className="pallet-header"><span className="checkbox">☐</span><span>Paleta nr {_0xmw4x+1}: {_0xgq1r} {_0xfp7q[_0xgq1r].name} - Termin: {_0xmw8x(_0xku3v.expiryDate)}</span></div><div className="components"><strong>Składowe:</strong>{_0xku3v.components&&_0xku3v.components.map((_0xoy5z,_0xqa6b)=>(<div key={_0xqa6b} className="component-item">• {_0xoy5z.index}: {_0xqa0b(_0xoy5z.quantity)} szt. (partia: {_0xoy5z.batch}, termin: {_0xmw8x(_0xoy5z.expiryDate)})</div>))}</div></div>))}</div>))}</div></div></div>)};const _0xsc7d=ReactDOM.createRoot(document.getElementById('root'));_0xsc7d.render(<_0xis5t/>);</script></body></html>
